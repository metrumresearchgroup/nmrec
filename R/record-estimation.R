parse_estimation_record <- function() {
  rp <- record_parser$new("estimation", private$name_raw, private$lines)
  process_options(rp, estimation_option_types, estimation_option_names)
  rp$assert_done()

  return(rp$get_values())
}

record_estimation <- R6::R6Class(
  "nmrec_record_estimation",
  inherit = record
)
record_estimation$set("private", "parse_fn", parse_estimation_record)

estimation_option_types <- list(
  "-2loglikelihood" = option_type_flag,
  "abort" = option_type_flag,
  "atol" = option_type_value,
  "auto" = option_type_value,
  "bayes_phi_store" = option_type_value,
  "bionly" = option_type_value,
  "bootdata" = option_type_value,
  "calpha" = option_type_value,
  "centering" = option_type_flag,
  "cinterval" = option_type_value,
  "citer" = option_type_value,
  "clockseed" = option_type_value,
  "constrain" = option_type_value,
  "ctype" = option_type_value,
  "dercont" = option_type_value,
  "df" = option_type_value,
  "dfs" = option_type_value,
  "eonly" = option_type_value,
  "etabarcheck" = option_type_flag,
  "etader" = option_type_value,
  "etasamples" = option_type_value,
  "etastype" = option_type_value,
  "fast" = option_type_flag,
  "file" = option_type_value,
  "fnleta" = option_type_value,
  "fo" = option_type_flag,
  "format" = option_type_value,
  "fparafile" = option_type_value,
  "grd" = option_type_value,
  "grdq" = option_type_value,
  "grid" = option_type_value,
  "iaccept" = option_type_value,
  "iacceptl" = option_type_value,
  "ikappa" = option_type_value,
  "interaction" = option_type_flag,
  "isampend" = option_type_value,
  "isample" = option_type_value,
  "isample_m1" = option_type_value,
  "isample_m1a" = option_type_value,
  "isample_m1b" = option_type_value,
  "isample_m2" = option_type_value,
  "isample_m3" = option_type_value,
  "iscale_max" = option_type_value,
  "iscale_min" = option_type_value,
  "kappa" = option_type_value,
  "knuthsumoff" = option_type_value,
  "laplacian" = option_type_flag,
  "levcenter" = option_type_value,
  "levwt" = option_type_value,
  "likelihood" = option_type_flag,
  "lntwopi" = option_type_flag,
  "madapt" = option_type_value,
  "mapcov" = option_type_value,
  "mapinter" = option_type_value,
  "mapiter" = option_type_value,
  "mapiters" = option_type_value,
  "massreset" = option_type_value,
  "maxevals" = option_type_value,
  "mceta" = option_type_value,
  "method" = option_type_value,
  "msfo" = option_type_value,
  "mum" = option_type_value,
  "nburn" = option_type_value,
  "niter" = option_type_value,
  "noabort" = option_type_flag,
  "nocentering" = option_type_flag,
  "nocov" = option_type_value,
  "noetabarcheck" = option_type_flag,
  "nofo" = option_type_flag,
  "nohabort" = option_type_flag,
  "nointeraction" = option_type_flag,
  "nolabel" = option_type_value,
  "nolaplacian" = option_type_flag,
  "noninfeta" = option_type_value,
  "nonumerical" = option_type_flag,
  "noomegaboundtest" = option_type_flag,
  "noposthoc" = option_type_flag,
  "noprior" = option_type_value,
  "norepeat" = option_type_flag,
  "norepeat1" = option_type_flag,
  "norepeat2" = option_type_flag,
  "nosigmaboundtest" = option_type_flag,
  "nosub" = option_type_value,
  "noslow" = option_type_value,
  "nosort" = option_type_flag,
  "nothetaboundtest" = option_type_flag,
  "notitle" = option_type_value,
  "numder" = option_type_value,
  "numerical" = option_type_flag,
  "nuts_base" = option_type_value,
  "nuts_delta" = option_type_value,
  "nuts_eparam" = option_type_value,
  "nuts_gamma" = option_type_value,
  "nuts_init" = option_type_value,
  "nuts_mass" = option_type_value,
  "nuts_maxdepth" = option_type_value,
  "nuts_oparam" = option_type_value,
  "nuts_reg" = option_type_value,
  "nuts_sparam" = option_type_value,
  "nuts_stepinter" = option_type_value,
  "nuts_stepiter" = option_type_value,
  "nuts_term" = option_type_value,
  "nuts_test" = option_type_value,
  "nuts_transform" = option_type_value,
  "oaccept" = option_type_value,
  "olkjdf" = option_type_value,
  "olntwopi" = option_type_value,
  "omegaboundtest" = option_type_flag,
  "omitted" = option_type_flag,
  "optmap" = option_type_value,
  "order" = option_type_value,
  "osample_m1" = option_type_value,
  "osample_m2" = option_type_value,
  "ovarf" = option_type_value,
  "paccept" = option_type_value,
  "parafile" = option_type_value,
  "parafprint" = option_type_value,
  "phitype" = option_type_value,
  "posthoc" = option_type_flag,
  "prediction" = option_type_flag,
  "print" = option_type_value,
  "priorc" = option_type_flag,
  "psample_m1" = option_type_value,
  "psample_m2" = option_type_value,
  "psample_m3" = option_type_value,
  "pscale_max" = option_type_value,
  "pscale_min" = option_type_value,
  "ranmethod" = option_type_value,
  "repeat" = option_type_flag,
  "repeat1" = option_type_flag,
  "repeat2" = option_type_flag,
  "saddle_hess" = option_type_value,
  "saddle_reset" = option_type_value,
  "seed" = option_type_value,
  "select" = option_type_value,
  "sigdigits" = option_type_value,
  "sigl" = option_type_value,
  "siglo" = option_type_value,
  "sigmaboundtest" = option_type_flag,
  "slkjdf" = option_type_value,
  "slow" = option_type_value,
  "sort" = option_type_flag,
  "stdobj" = option_type_value,
  "stieltjes" = option_type_flag,
  "svarf" = option_type_value,
  "tbln" = option_type_value,
  "thetaboundtest" = option_type_flag,
  "thin" = option_type_value,
  "tpu" = option_type_value,
  "ttdf" = option_type_value,
  "zero" = option_type_value
)

estimation_option_names <- list2env(
  list(
    "-2l" = "-2loglikelihood",
    "-2ll" = "-2loglikelihood",
    "-2llikelihood" = "-2loglikelihood",
    "-2lo" = "-2loglikelihood",
    "-2log" = "-2loglikelihood",
    "-2logl" = "-2loglikelihood",
    "-2logli" = "-2loglikelihood",
    "-2loglik" = "-2loglikelihood",
    "-2loglike" = "-2loglikelihood",
    "-2loglikel" = "-2loglikelihood",
    "-2loglikeli" = "-2loglikelihood",
    "-2loglikelih" = "-2loglikelihood",
    "-2loglikeliho" = "-2loglikelihood",
    "-2loglikelihoo" = "-2loglikelihood",
    "-2loglikelihood" = "-2loglikelihood",
    "abo" = "abort",
    "abor" = "abort",
    "abort" = "abort",
    "atol" = "atol",
    "auto" = "auto",
    "bayes_phi_store" = "bayes_phi_store",
    "bionly" = "bionly",
    "bootdata" = "bootdata",
    "calpha" = "calpha",
    "cen" = "centering",
    "cent" = "centering",
    "cente" = "centering",
    "center" = "centering",
    "centeri" = "centering",
    "centerin" = "centering",
    "centering" = "centering",
    "cinterval" = "cinterval",
    "citer" = "citer",
    "clockseed" = "clockseed",
    "cnsamp" = "citer",
    "constrain" = "constrain",
    "ctype" = "ctype",
    "delim" = "format",
    "dercont" = "dercont",
    "df" = "df",
    "dfs" = "dfs",
    "eonly" = "eonly",
    "eta" = "etabarcheck",
    "etab" = "etabarcheck",
    "etaba" = "etabarcheck",
    "etabar" = "etabarcheck",
    "etabarc" = "etabarcheck",
    "etabarch" = "etabarcheck",
    "etabarche" = "etabarcheck",
    "etabarchec" = "etabarcheck",
    "etabarcheck" = "etabarcheck",
    "etader" = "etader",
    "etasample" = "etasamples",
    "etasamples" = "etasamples",
    "etastype" = "etastype",
    "fast" = "fast",
    "file" = "file",
    "fnleta" = "fnleta",
    "fo" = "fo",
    "format" = "format",
    "fparafile" = "fparafile",
    "grd" = "grd",
    "grdq" = "grdq",
    "gri" = "grid",
    "grid" = "grid",
    "iaccept" = "iaccept",
    "iacceptl" = "iacceptl",
    "ikappa" = "ikappa",
    "int" = "interaction",
    "inte" = "interaction",
    "inter" = "interaction",
    "intera" = "interaction",
    "interac" = "interaction",
    "interact" = "interaction",
    "interacti" = "interaction",
    "interactio" = "interaction",
    "interaction" = "interaction",
    "isampend" = "isampend",
    "isample" = "isample",
    "isample_m1" = "isample_m1",
    "isample_m1a" = "isample_m1a",
    "isample_m1b" = "isample_m1b",
    "isample_m2" = "isample_m2",
    "isample_m3" = "isample_m3",
    "iscale_max" = "iscale_max",
    "iscale_min" = "iscale_min",
    "kappa" = "kappa",
    "knuthsumoff" = "knuthsumoff",
    "lap" = "laplacian",
    "lapl" = "laplacian",
    "lapla" = "laplacian",
    "laplac" = "laplacian",
    "laplace" = "laplacian",
    "laplaci" = "laplacian",
    "laplacia" = "laplacian",
    "laplacian" = "laplacian",
    "levcenter" = "levcenter",
    "levwt" = "levwt",
    "lik" = "likelihood",
    "like" = "likelihood",
    "likel" = "likelihood",
    "likeli" = "likelihood",
    "likelih" = "likelihood",
    "likeliho" = "likelihood",
    "likelihoo" = "likelihood",
    "likelihood" = "likelihood",
    "lnt" = "lntwopi",
    "lntw" = "lntwopi",
    "lntwo" = "lntwopi",
    "lntwop" = "lntwopi",
    "lntwopi" = "lntwopi",
    "madapt" = "madapt",
    "mapcov" = "mapcov",
    "mapinter" = "mapinter",
    "mapiter" = "mapiter",
    "mapiters" = "mapiters",
    "massreset" = "massreset",
    "max" = "maxevals",
    "maxe" = "maxevals",
    "maxev" = "maxevals",
    "maxeva" = "maxevals",
    "maxeval" = "maxevals",
    "maxevals" = "maxevals",
    "mceta" = "mceta",
    "met" = "method",
    "meth" = "method",
    "metho" = "method",
    "method" = "method",
    "msf" = "msfo",
    "msfo" = "msfo",
    "mum" = "mum",
    "nburn" = "nburn",
    "niter" = "niter",
    "noa" = "noabort",
    "noab" = "noabort",
    "noabo" = "noabort",
    "noabor" = "noabort",
    "noabort" = "noabort",
    "noc" = "nocentering",
    "noce" = "nocentering",
    "nocen" = "nocentering",
    "nocent" = "nocentering",
    "nocente" = "nocentering",
    "nocenter" = "nocentering",
    "nocenteri" = "nocentering",
    "nocenterin" = "nocentering",
    "nocentering" = "nocentering",
    "nocov" = "nocov",
    "noe" = "noetabarcheck",
    "noet" = "noetabarcheck",
    "noeta" = "noetabarcheck",
    "noetab" = "noetabarcheck",
    "noetaba" = "noetabarcheck",
    "noetabar" = "noetabarcheck",
    "noetabarc" = "noetabarcheck",
    "noetabarch" = "noetabarcheck",
    "noetabarche" = "noetabarcheck",
    "noetabarchec" = "noetabarcheck",
    "noetabarcheck" = "noetabarcheck",
    "nofo" = "nofo",
    "noh" = "nohabort",
    "noha" = "nohabort",
    "nohab" = "nohabort",
    "nohabo" = "nohabort",
    "nohabor" = "nohabort",
    "nohabort" = "nohabort",
    "noi" = "nointeraction",
    "noin" = "nointeraction",
    "noint" = "nointeraction",
    "nointe" = "nointeraction",
    "nointer" = "nointeraction",
    "nointera" = "nointeraction",
    "nointerac" = "nointeraction",
    "nointeract" = "nointeraction",
    "nointeracti" = "nointeraction",
    "nointeractio" = "nointeraction",
    "nointeraction" = "nointeraction",
    "nolabel" = "nolabel",
    "nol" = "nolaplacian",
    "nola" = "nolaplacian",
    "nolap" = "nolaplacian",
    "nolapl" = "nolaplacian",
    "nolapla" = "nolaplacian",
    "nolaplac" = "nolaplacian",
    "nolaplaci" = "nolaplacian",
    "nolaplacia" = "nolaplacian",
    "nolaplacian" = "nolaplacian",
    "noninfeta" = "noninfeta",
    "non" = "nonumerical",
    "nonu" = "nonumerical",
    "nonum" = "nonumerical",
    "nonume" = "nonumerical",
    "nonumer" = "nonumerical",
    "nonumeri" = "nonumerical",
    "nonumeric" = "nonumerical",
    "nonumerica" = "nonumerical",
    "nonumerical" = "nonumerical",
    "nooboundtest" = "noomegaboundtest",
    "noobt" = "noomegaboundtest",
    "noomegaboundtest" = "noomegaboundtest",
    "nop" = "noposthoc",
    "nopo" = "noposthoc",
    "nopos" = "noposthoc",
    "nopost" = "noposthoc",
    "noposth" = "noposthoc",
    "nopostho" = "noposthoc",
    "noposthoc" = "noposthoc",
    "noprior" = "noprior",
    "nor" = "norepeat",
    "nore" = "norepeat",
    "norep" = "norepeat",
    "norepe" = "norepeat",
    "norepea" = "norepeat",
    "norepeat" = "norepeat",
    "norepeat1" = "norepeat1",
    "norepeat2" = "norepeat2",
    "nosboundtest" = "nosigmaboundtest",
    "nosbt" = "nosigmaboundtest",
    "nosigmaboundtest" = "nosigmaboundtest",
    "noslow" = "noslow",
    "nosort" = "nosort",
    "nosub" = "nosub",
    "notboundtest" = "nothetaboundtest",
    "notbt" = "nothetaboundtest",
    "nothetaboundtest" = "nothetaboundtest",
    "notitle" = "notitle",
    "nsample" = "niter",
    "nsi" = "sigdigits",
    "nsig" = "sigdigits",
    "nsigd" = "sigdigits",
    "nsigdi" = "sigdigits",
    "nsigdig" = "sigdigits",
    "nsigdigi" = "sigdigits",
    "nsigdigit" = "sigdigits",
    "nsigdigits" = "sigdigits",
    "numder" = "numder",
    "num" = "numerical",
    "nume" = "numerical",
    "numer" = "numerical",
    "numeri" = "numerical",
    "numeric" = "numerical",
    "numerica" = "numerical",
    "numerical" = "numerical",
    "nuts_base" = "nuts_base",
    "nuts_delta" = "nuts_delta",
    "nuts_eparam" = "nuts_eparam",
    "nuts_gamma" = "nuts_gamma",
    "nuts_init" = "nuts_init",
    "nuts_mass" = "nuts_mass",
    "nuts_maxdepth" = "nuts_maxdepth",
    "nuts_oparam" = "nuts_oparam",
    "nuts_reg" = "nuts_reg",
    "nuts_sparam" = "nuts_sparam",
    "nuts_stepinter" = "nuts_stepinter",
    "nuts_stepiter" = "nuts_stepiter",
    "nuts_term" = "nuts_term",
    "nuts_test" = "nuts_test",
    "nuts_transform" = "nuts_transform",
    "oaccept" = "oaccept",
    "oboundtest" = "omegaboundtest",
    "obt" = "omegaboundtest",
    "olkjdf" = "olkjdf",
    "oln" = "olntwopi",
    "olnt" = "olntwopi",
    "olntw" = "olntwopi",
    "olntwo" = "olntwopi",
    "olntwop" = "olntwopi",
    "olntwopi" = "olntwopi",
    "omegaboundtest" = "omegaboundtest",
    "omi" = "omitted",
    "omit" = "omitted",
    "omitt" = "omitted",
    "omitte" = "omitted",
    "omitted" = "omitted",
    "optmap" = "optmap",
    "order" = "order",
    "osample_m1" = "osample_m1",
    "osample_m2" = "osample_m2",
    "ovarf" = "ovarf",
    "paccept" = "paccept",
    "parafile" = "parafile",
    "parafprint" = "parafprint",
    "phitype" = "phitype",
    "pos" = "posthoc",
    "post" = "posthoc",
    "posth" = "posthoc",
    "postho" = "posthoc",
    "posthoc" = "posthoc",
    "pre" = "prediction",
    "pred" = "prediction",
    "predi" = "prediction",
    "predic" = "prediction",
    "predict" = "prediction",
    "predicti" = "prediction",
    "predictio" = "prediction",
    "prediction" = "prediction",
    "pri" = "print",
    "prin" = "print",
    "print" = "print",
    "prio" = "priorc",
    "prior" = "priorc",
    "priorc" = "priorc",
    "psample_m1" = "psample_m1",
    "psample_m2" = "psample_m2",
    "psample_m3" = "psample_m3",
    "pscale_max" = "pscale_max",
    "pscale_min" = "pscale_min",
    "ranmethod" = "ranmethod",
    "rep" = "repeat",
    "repe" = "repeat",
    "repea" = "repeat",
    "repeat" = "repeat",
    "repeat1" = "repeat1",
    "repeat2" = "repeat2",
    "saddle_hess" = "saddle_hess",
    "saddle_reset" = "saddle_reset",
    "sboundtest" = "sigmaboundtest",
    "sbt" = "sigmaboundtest",
    "seed" = "seed",
    "select" = "select",
    "sig" = "sigdigits",
    "sigd" = "sigdigits",
    "sigdi" = "sigdigits",
    "sigdig" = "sigdigits",
    "sigdigi" = "sigdigits",
    "sigdigit" = "sigdigits",
    "sigdigits" = "sigdigits",
    "sigl" = "sigl",
    "siglo" = "siglo",
    "sigmaboundtest" = "sigmaboundtest",
    "slkjdf" = "slkjdf",
    "slow" = "slow",
    "sort" = "sort",
    "stdobj" = "stdobj",
    "sti" = "stieltjes",
    "stie" = "stieltjes",
    "stiel" = "stieltjes",
    "stielt" = "stieltjes",
    "stieltj" = "stieltjes",
    "stieltje" = "stieltjes",
    "stieltjes" = "stieltjes",
    "svarf" = "svarf",
    "tbln" = "tbln",
    "tboundtest" = "thetaboundtest",
    "tbt" = "thetaboundtest",
    "thetaboundtest" = "thetaboundtest",
    "thin" = "thin",
    "tpu" = "tpu",
    "ttdf" = "ttdf",
    "zer" = "zero",
    "zero" = "zero"
  ),
  parent = emptyenv()
)
