#' Normalize various spellings of a record name
#'
#' @noRd
resolve_record_name <- function(name) {
  n <- get0(tolower(name), record_names)
  if (is.null(n)) {
    abort(
      paste("Unknown record type:", deparse_string(name)),
      nmrec_error("unknown_record")
    )
  }

  return(n)
}

record_names <- list2env(
  list(
    "abb" = "abbreviated",
    "abbr" = "abbreviated",
    "abbre" = "abbreviated",
    "abbrev" = "abbreviated",
    "abbrevi" = "abbreviated",
    "abbrevia" = "abbreviated",
    "abbreviat" = "abbreviated",
    "abbreviate" = "abbreviated",
    "abbreviated" = "abbreviated",
    "aes" = "aes",
    "aes0" = "aesinit",
    "aesi" = "aesinit",
    "aesin" = "aesinit",
    "aesini" = "aesinit",
    "aesinit" = "aesinit",
    "ann" = "anneal",
    "anne" = "anneal",
    "annea" = "anneal",
    "anneal" = "anneal",
    "bin" = "bind",
    "bind" = "bind",
    "cha" = "chain",
    "chai" = "chain",
    "chain" = "chain",
    "con" = "contr",
    "cont" = "contr",
    "contr" = "contr",
    "cov" = "covariance",
    "cova" = "covariance",
    "covar" = "covariance",
    "covari" = "covariance",
    "covaria" = "covariance",
    "covarian" = "covariance",
    "covarianc" = "covariance",
    "covariance" = "covariance",
    "covr" = "covariance",
    "dat" = "data",
    "data" = "data",
    "def" = "default",
    "defa" = "default",
    "defau" = "default",
    "defaul" = "default",
    "default" = "default",
    "defaults" = "default",
    "des" = "des",
    "desi" = "design",
    "desig" = "design",
    "design" = "design",
    "err" = "error",
    "erro" = "error",
    "error" = "error",
    "est" = "estimation",
    "esti" = "estimation",
    "estim" = "estimation",
    "estima" = "estimation",
    "estimat" = "estimation",
    "estimate" = "estimation",
    "estimati" = "estimation",
    "estimatio" = "estimation",
    "estimation" = "estimation",
    "estm" = "estimation",
    "eta" = "etas",
    "etas" = "etas",
    "for" = "format",
    "form" = "format",
    "forma" = "format",
    "format" = "format",
    "ind" = "index",
    "inde" = "index",
    "index" = "index",
    "indexe" = "index",
    "indexes" = "index",
    "indx" = "index",
    "indxs" = "index",
    "inf" = "data",
    "infi" = "data",
    "infil" = "data",
    "infile" = "data",
    "infn" = "infn",
    "inp" = "input",
    "inpu" = "input",
    "input" = "input",
    "lev" = "level",
    "leve" = "level",
    "level" = "level",
    "mix" = "mix",
    "mod" = "model",
    "mode" = "model",
    "model" = "model",
    "msf" = "msfi",
    "msfi" = "msfi",
    "non" = "nonparametric",
    "nonp" = "nonparametric",
    "nonpa" = "nonparametric",
    "nonpar" = "nonparametric",
    "nonpara" = "nonparametric",
    "nonparam" = "nonparametric",
    "nonparame" = "nonparametric",
    "nonparamet" = "nonparametric",
    "nonparametr" = "nonparametric",
    "nonparametri" = "nonparametric",
    "nonparametric" = "nonparametric",
    "olk" = "olkjdf",
    "olkj" = "olkjdf",
    "olkjd" = "olkjdf",
    "olkjdf" = "olkjdf",
    "ome" = "omega",
    "omeg" = "omega",
    "omega" = "omega",
    "omegap" = "omegap",
    "omegapd" = "omegapd",
    "omi" = "omit",
    "omit" = "omit",
    "opt" = "design",
    "optd" = "design",
    "optde" = "design",
    "optdes" = "design",
    "optdesi" = "design",
    "optdesig" = "design",
    "optdesign" = "design",
    "ova" = "ovarf",
    "ovar" = "ovarf",
    "ovarf" = "ovarf",
    "phi" = "phis",
    "phis" = "phis",
    "pk" = "pk",
    "pre" = "pred",
    "pred" = "pred",
    "pri" = "prior",
    "prio" = "prior",
    "prior" = "prior",
    "pro" = "problem",
    "prob" = "problem",
    "probl" = "problem",
    "proble" = "problem",
    "problem" = "problem",
    "rco" = "rcov",
    "rcov" = "rcov",
    "rcovi" = "rcovi",
    "sca" = "scatterplot",
    "scat" = "scatterplot",
    "scatt" = "scatterplot",
    "scatte" = "scatterplot",
    "scatter" = "scatterplot",
    "scatterg" = "scatterplot",
    "scattergr" = "scatterplot",
    "scattergra" = "scatterplot",
    "scattergram" = "scatterplot",
    "scattergrams" = "scatterplot",
    "scatterp" = "scatterplot",
    "scatterpl" = "scatterplot",
    "scatterplo" = "scatterplot",
    "scatterplot" = "scatterplot",
    "scatters" = "scatterplot",
    "sig" = "sigma",
    "sigm" = "sigma",
    "sigma" = "sigma",
    "sigmap" = "sigmap",
    "sigmapd" = "sigmapd",
    "sim" = "simulation",
    "siml" = "simulation",
    "simu" = "simulation",
    "simul" = "simulation",
    "simula" = "simulation",
    "simulat" = "simulation",
    "simulate" = "simulation",
    "simulati" = "simulation",
    "simulatio" = "simulation",
    "simulation" = "simulation",
    "siz" = "sizes",
    "size" = "sizes",
    "sizes" = "sizes",
    "slk" = "slkjdf",
    "slkj" = "slkjdf",
    "slkjd" = "slkjdf",
    "slkjdf" = "slkjdf",
    "sub" = "subroutines",
    "subr" = "subroutines",
    "subro" = "subroutines",
    "subrou" = "subroutines",
    "subrout" = "subroutines",
    "subrouti" = "subroutines",
    "subroutin" = "subroutines",
    "subroutine" = "subroutines",
    "subroutines" = "subroutines",
    "subs" = "subroutines",
    "sup" = "super",
    "supe" = "super",
    "super" = "super",
    "sva" = "svarf",
    "svar" = "svarf",
    "svarf" = "svarf",
    "tab" = "table",
    "tabl" = "table",
    "table" = "table",
    "thta" = "theta",
    "the" = "theta",
    "thet" = "theta",
    "theta" = "theta",
    "thi" = "thetai",
    "thetai" = "thetai",
    "thetap" = "thetap",
    "thetapv" = "thetapv",
    "thr" = "thetar",
    "thetar" = "thetar",
    "tol" = "tol",
    "ttd" = "ttdf",
    "ttdf" = "ttdf",
    "war" = "warnings",
    "warn" = "warnings",
    "warni" = "warnings",
    "warnin" = "warnings",
    "warning" = "warnings",
    "warnings" = "warnings"
  ),
  parent = emptyenv()
)
